## 第5章 为什么使用组件 Why use components ##

使用面向组件编程（component-oriented programming）的理由如下：

1. 关注点分离（Separation of Concerns）。
2. 更容易应用通用设计模式。
3. 组件更易于构建和配置。
4. 组件更容易管理。
5. 组件意味着更易于进行单元测试。
6. 组件促进高级的应用程序架构而无需修改代码。


所有这些原因都促进更好的应用程序设计。下面分别探讨这几个方面的细节。


<br/>

#### <font size=3><b>关注点分离 Separation of Concerns</b></font> ####

**关注点分离**是非常简单的概念，它的名字已自解释了它的含义。它是一种设计模式，鼓励系统的每一个部分都有一个清晰的关注点（concern），也被称为角色 role 或者功能 function。各个部分之间的边界也应定义清楚。

使用组件可以帮助我们将分离的关注点应用于自己的程序设计。组件间的关系从外部表示，并可以随时改变而无需改变组件自身。因此通过关注点分离，使它更加自然地倾向于组件设计。

<br/>

#### <font size=3><b>更容易应用通用的设计模式</b></font> ####

在面向组件的设计中，使用关注点分离是最重要的设计模式，容器功能的使用，可以通过简单的、一致的形式使用其它设计模式。例如，命令链模式（the chain of command pattern）在定义一系列动作时非常有用，可以通过声明要求一个组件实例列表的形式实现。

<br/>

#### <font size=3><b>组件更易于构建和配置</b></font> ####

随着应用程序设计越来越复杂，组件中会有很多的字段需要操纵。容器中的特性可以帮助对象的构建，使它可以比以往更快地进行开发，使用很少的代码。

一个组件可以声明其默认的配置，但包含某种形式，可以在运行时从系统获取信息以对它进行操纵，而不需要在设计时知道目标应用的任何信息。目标应用可以完全按照自己的需要整个覆盖掉默认的配置，或者基于运行时环境因素。

在 Plexus 中，配置和构建不仅仅限制在对原生字段的设置上。复杂的对象可以通过 XML 片段进行配置。组件也可以有其它组件配置或者注入进来，通过声明要求（requirement）使构建非常简单。这些要求当然可以由目标应用来改变，以由不同的实现替换。

<br/>

#### <font size=3><b>组件更容易管理</b></font> ####

组件不仅仅易于构建，一个优秀的组件容器，例如 Plexus，也更容易管理它们在一个应用中的生命周期。

在 Java 中，只能控制对象的构造（调用构造器）以及调用对象上的方法。其它行为例如析构（finalization ）不能以可预见的形式调用，也不能用于执行对象的清理。

在支持组件生命周期的组件中，例如 Plexus，组件的作者对组件生命周期的所有方面都可以完全掌控。例如，组件在完成 initialized, started, stopped, 或者 destroyed 等等类似的名称时，可以进行交互。在 Plexus 中，不仅组件可以参与到生命周期中，组件的生命周期也可以完全自定义。

参与到组件声明周期的能力，使组件作者可以执行必要的开始 set up 和清理 clean up 工作，也易于对组件应用某些设计模式，而无需重新编写组件代码进行状态处理。


<br/>

#### <font size=3><b>组件意味着更易于进行单元测试</b></font> ####

以上特性使组件更易于进行单元测试。在测试代码时，通常期望在隔离环境中进行测试，因此测试不受外部因素的影响，因此测试更加简单也更容易编写。通过关注点分离，使这种需求成为现实。

另外，因为组件构建和配置是可以改变的，很容易通过其它组件替换默认的实现，使用简单的 mock 或 stub 确保一次测试一个简单的组件。

测试一般会要求一定数量的对象配置，大多数都是重复的，除了其中的一两个值。使用组件容器可以轻易使用预设配置（pre-set configuration），在每个测试中再分别修改各自很少的配置。

最后，由于组件测试可以运行在容器中，组件的生命周期可以作为在真实的系统中执行，不需要构造调用对象。获得更容易地隔离测试组件。



<br/>

#### <font size=3><b>组件促进高级的应用程序架构而无需修改代码</b></font> ####

理清组件的分离，有了明确的接口定义，允许使用其它实现替换该组件。这样可以使用高级的应用程序架构而无需进行代码修改。



<br/><br/>
<a id="1"></a>

## 5.1 组件是什么 What are Components? ##

Szyperski（苏兹斯基，《组件编程：超越面向对象》作者 Component Software: Beyond Object-Oriented）列出了组件的几个特征：

- **composition** ：组合体
- **units of deployment**：部署的单元
- **resuability**：可重用性

<br/>

#### <font size=3><b>一些组件的描述：</b></font> ####

- 是系统中非凡的、几乎独立的、可替换的部分，在定义明确的体系结构的环境中执行清晰的功能。一个组件遵照一些列接口并提供物理实现（(Philippe Krutchen, Rational Software)）。
- 一个运行时软件组件是一个动态可绑定的包（a dynamically bindable package），由一个或多个程序作为一个单元管理，并通过接口访问，可以在运行时发现（Gartner Group）。
- 一个软件组件只是一个由规范的接口以及显式地环境依赖组合而成的单元。一个软件组件可以被独立部署，并且受第三方组件支配 (Clemens Szyperski, "Component Software")。





